# Cloudflared Web + Cloudflare Worker ç¶­é‹æ‰‹å†Š ğŸš€

é€™æ˜¯é‡å°ä½ å®Œæ•´å°ˆæ¡ˆçš„ç¶­é‹æ‰‹å†Šï¼Œç¢ºä¿æœªä¾†å³ä½¿äº¤æ¥ã€æ“´å±•ã€æˆ–é‡åˆ°å•é¡Œæ™‚ï¼Œä¹Ÿèƒ½å¿«é€Ÿå®šä½èˆ‡ä¿®å¾©ã€‚

---

## ğŸ“¦ å°ˆæ¡ˆæ¶æ§‹å›é¡§

- Cloudflare Worker â” å‹•æ…‹ä»£ç†æµé‡
- Cloudflared Web UI (Docker) â” ç®¡ç† Cloudflare Tunnel
- GitHub Actions â” è‡ªå‹•éƒ¨ç½² Cloudflare Worker
- GitHub Secrets â” å„²å­˜æ•æ„Ÿè³‡è¨Šï¼ˆCF_ACCOUNT_ID / CF_API_TOKEN / TUNNEL_HOSTNAMEï¼‰

---

## ğŸ› ï¸ æ—¥å¸¸ç¶­é‹

### 1. æª¢æŸ¥ Tunnel ç‹€æ…‹
- ç™»å…¥ Cloudflared Web UIï¼š`http://localhost:14333`
- æª¢æŸ¥ Tunnel æ˜¯å¦åœ¨ç·šï¼Œè‹¥ç•°å¸¸å¯æ‰‹å‹•å•Ÿå‹• / åœæ­¢ Tunnelã€‚

### 2. æ›´æ–° Worker ç¨‹å¼
- ä¿®æ”¹ `index.js`
- Push åˆ° `main` åˆ†æ”¯ï¼ŒGitHub Actions æœƒè‡ªå‹•éƒ¨ç½²ã€‚

### 3. ç®¡ç† Docker
æŸ¥çœ‹å®¹å™¨ç‹€æ…‹ï¼š
```bash
docker ps
```
é‡å•Ÿ Cloudflared Web UIï¼š
```bash
docker restart cloudflared
```

### 4. æ›´æ–° Secretsï¼ˆæ›´æ› Token æˆ–å¸³è™Ÿ IDï¼‰
- å‰å¾€ GitHub Repository â” Settings â” Secrets â” Actions
- ç·¨è¼¯ `CF_ACCOUNT_ID` / `CF_API_TOKEN` / `TUNNEL_HOSTNAME`
- Push ä»»ä¸€ commit è§¸ç™¼è‡ªå‹•éƒ¨ç½²

---

## ğŸ” éŒ¯èª¤æ’æŸ¥æŒ‡å—

| å•é¡Œæè¿° | æ’æŸ¥æ­¥é©Ÿ |
|-----------|------------|
| Worker ç¶²ç«™ç„¡æ³•æ‰“é–‹ | 1. ç¢ºèª GitHub Actions éƒ¨ç½²æ˜¯å¦æˆåŠŸ<br>2. æª¢æŸ¥ Cloudflare Worker è¨­å®šå’Œè·¯ç”± |
| Tunnel é›¢ç·š / éŒ¯èª¤ 502 | 1. ç™»å…¥ Web UI ç¢ºèª Tunnel ç‹€æ…‹<br>2. ç¢ºèªæœ¬åœ°æœå‹™æ˜¯å¦æ­£å¸¸å•Ÿå‹• (Home Assistant / NAS) |
| GitHub Actions éƒ¨ç½²å¤±æ•— | 1. æª¢æŸ¥ Secrets æ˜¯å¦éæœŸ<br>2. æŸ¥çœ‹ Actions æ—¥èªŒéŒ¯èª¤è¨Šæ¯ |
| æ›´æ–°å¾Œæœªç”Ÿæ•ˆ | 1. ç¢ºèªæ˜¯å¦æœ‰è§¸ç™¼éƒ¨ç½²æµç¨‹<br>2. å¼·åˆ¶åˆ·æ–°ç€è¦½å™¨ Cache |

---

## ğŸ”„ è‡ªå‹•åŒ–å»ºè­°ï¼ˆé€²éšï¼‰

- âœ… **Watchtower**ï¼šè‡ªå‹•æ›´æ–° Docker å®¹å™¨
- âœ… **Webhook + GitHub Actions**ï¼šè‡ªå‹•é€šçŸ¥éƒ¨ç½²æˆåŠŸæˆ–å¤±æ•—
- âœ… **UptimeRobot / Healthchecks.io**ï¼šç›£æ§æœå‹™å¥åº·ç‹€æ…‹ä¸¦å³æ™‚é€šçŸ¥

---

## ğŸ“‹ ç¶­é‹å°æŠ„

| æŒ‡ä»¤ | èªªæ˜ |
|------|------|
| `npm run deploy` | æ‰‹å‹•éƒ¨ç½² Worker |
| `docker restart cloudflared` | é‡å•Ÿ Cloudflared Web UI å®¹å™¨ |
| `docker logs cloudflared` | æŸ¥çœ‹ Cloudflared é‹è¡Œæ—¥èªŒ |
| `git push origin main` | æ¨é€ä»£ç¢¼ä¸¦è‡ªå‹•éƒ¨ç½² |

---

## âœ… ç¶­é‹æª¢æŸ¥æ¸…å–®

- [ ] GitHub Secrets å®šæœŸæ›´æ–°ï¼Ÿ
- [ ] Docker å®¹å™¨æ­£å¸¸é‹è¡Œï¼Ÿ
- [ ] Tunnel ç¶­æŒåœ¨ç·šï¼Ÿ
- [ ] Worker URL æ­£å¸¸å­˜å–ï¼Ÿ
- [ ] è‡ªå‹•åŒ–æµç¨‹å®šæœŸæª¢æŸ¥ï¼Ÿ

---



